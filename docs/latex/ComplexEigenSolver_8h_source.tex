\doxysection{Complex\+Eigen\+Solver.\+h}
\hypertarget{ComplexEigenSolver_8h_source}{}\label{ComplexEigenSolver_8h_source}\index{nuli-\/avionics-\/flight-\/software/platformio\_nuli\_avionics\_flight\_software/include/Eigen/src/Eigenvalues/ComplexEigenSolver.h@{nuli-\/avionics-\/flight-\/software/platformio\_nuli\_avionics\_flight\_software/include/Eigen/src/Eigenvalues/ComplexEigenSolver.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2009\ Claire\ Maurice}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (C)\ 2009\ Gael\ Guennebaud\ <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ Copyright\ (C)\ 2010,2012\ Jitse\ Niesen\ <jitse@maths.leeds.ac.uk>}}
\DoxyCodeLine{00007\ \textcolor{comment}{//}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_COMPLEX\_EIGEN\_SOLVER\_H}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#define\ EIGEN\_COMPLEX\_EIGEN\_SOLVER\_H}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}./ComplexSchur.h"{}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceEigen}{Eigen}}\ \{\ }
\DoxyCodeLine{00018\ \textcolor{comment}{}}
\DoxyCodeLine{00019\ \textcolor{comment}{/**\ \(\backslash\)eigenvalues\_module\ \(\backslash\)ingroup\ Eigenvalues\_Module}}
\DoxyCodeLine{00020\ \textcolor{comment}{\ \ *}}
\DoxyCodeLine{00021\ \textcolor{comment}{\ \ *}}
\DoxyCodeLine{00022\ \textcolor{comment}{\ \ *\ \(\backslash\)class\ ComplexEigenSolver}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ \ *}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ \ *\ \(\backslash\)brief\ Computes\ eigenvalues\ and\ eigenvectors\ of\ general\ complex\ matrices}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ \ *}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ \ *\ \(\backslash\)tparam\ \_MatrixType\ the\ type\ of\ the\ matrix\ of\ which\ we\ are}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ \ *\ computing\ the\ eigendecomposition;\ this\ is\ expected\ to\ be\ an}}
\DoxyCodeLine{00028\ \textcolor{comment}{\ \ *\ instantiation\ of\ the\ Matrix\ class\ template.}}
\DoxyCodeLine{00029\ \textcolor{comment}{\ \ *}}
\DoxyCodeLine{00030\ \textcolor{comment}{\ \ *\ The\ eigenvalues\ and\ eigenvectors\ of\ a\ matrix\ \(\backslash\)f\$\ A\ \(\backslash\)f\$\ are\ scalars}}
\DoxyCodeLine{00031\ \textcolor{comment}{\ \ *\ \(\backslash\)f\$\ \(\backslash\)lambda\ \(\backslash\)f\$\ and\ vectors\ \(\backslash\)f\$\ v\ \(\backslash\)f\$\ such\ that\ \(\backslash\)f\$\ Av\ =\ \(\backslash\)lambda\ v}}
\DoxyCodeLine{00032\ \textcolor{comment}{\ \ *\ \(\backslash\)f\$.\ \ If\ \(\backslash\)f\$\ D\ \(\backslash\)f\$\ is\ a\ diagonal\ matrix\ with\ the\ eigenvalues\ on}}
\DoxyCodeLine{00033\ \textcolor{comment}{\ \ *\ the\ diagonal,\ and\ \(\backslash\)f\$\ V\ \(\backslash\)f\$\ is\ a\ matrix\ with\ the\ eigenvectors\ as}}
\DoxyCodeLine{00034\ \textcolor{comment}{\ \ *\ its\ columns,\ then\ \(\backslash\)f\$\ A\ V\ =\ V\ D\ \(\backslash\)f\$.\ The\ matrix\ \(\backslash\)f\$\ V\ \(\backslash\)f\$\ is}}
\DoxyCodeLine{00035\ \textcolor{comment}{\ \ *\ almost\ always\ invertible,\ in\ which\ case\ we\ have\ \(\backslash\)f\$\ A\ =\ V\ D\ V\string^\{-\/1\}}}
\DoxyCodeLine{00036\ \textcolor{comment}{\ \ *\ \(\backslash\)f\$.\ This\ is\ called\ the\ eigendecomposition.}}
\DoxyCodeLine{00037\ \textcolor{comment}{\ \ *}}
\DoxyCodeLine{00038\ \textcolor{comment}{\ \ *\ The\ main\ function\ in\ this\ class\ is\ compute(),\ which\ computes\ the}}
\DoxyCodeLine{00039\ \textcolor{comment}{\ \ *\ eigenvalues\ and\ eigenvectors\ of\ a\ given\ function.\ The}}
\DoxyCodeLine{00040\ \textcolor{comment}{\ \ *\ documentation\ for\ that\ function\ contains\ an\ example\ showing\ the}}
\DoxyCodeLine{00041\ \textcolor{comment}{\ \ *\ main\ features\ of\ the\ class.}}
\DoxyCodeLine{00042\ \textcolor{comment}{\ \ *}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ \ *\ \(\backslash\)sa\ class\ EigenSolver,\ class\ SelfAdjointEigenSolver}}
\DoxyCodeLine{00044\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00045\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType>\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a3322a21574c61eefd450c003515ad802}{ComplexEigenSolver}}}
\DoxyCodeLine{00046\ \{}
\DoxyCodeLine{00047\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00048\ \textcolor{comment}{}}
\DoxyCodeLine{00049\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Synonym\ for\ the\ template\ parameter\ \(\backslash\)p\ \_MatrixType.\ */}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_ad61f6278843a601096276c9a72c0252f}{MatrixType}};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ RowsAtCompileTime\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00054\ \ \ \ \ \ \ ColsAtCompileTime\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00055\ \ \ \ \ \ \ Options\ =\ MatrixType::Options,}
\DoxyCodeLine{00056\ \ \ \ \ \ \ MaxRowsAtCompileTime\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00057\ \ \ \ \ \ \ MaxColsAtCompileTime\ =\ MatrixType::MaxColsAtCompileTime}
\DoxyCodeLine{00058\ \ \ \ \ \};}
\DoxyCodeLine{00059\ \textcolor{comment}{}}
\DoxyCodeLine{00060\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Scalar\ type\ for\ matrices\ of\ type\ \#MatrixType.\ */}}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a61035d40c9498bb1d47628cdd4946785}{Scalar}};}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ NumTraits<Scalar>::Real\ RealScalar;}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Eigen::Index}}\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_abc0218d8b902af0d6c759bfc0a8a8d74}{Index}};\ \textcolor{comment}{///<\ \(\backslash\)deprecated\ since\ Eigen\ 3.3}}
\DoxyCodeLine{00064\ \textcolor{comment}{}}
\DoxyCodeLine{00065\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Complex\ scalar\ type\ for\ \#MatrixType.}}
\DoxyCodeLine{00066\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00067\ \textcolor{comment}{\ \ \ \ \ \ *\ This\ is\ \(\backslash\)c\ std::complex<Scalar>\ if\ \#Scalar\ is\ real\ (e.g.,}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)c\ float\ or\ \(\backslash\)c\ double)\ and\ just\ \(\backslash\)c\ Scalar\ if\ \#Scalar\ is}}
\DoxyCodeLine{00069\ \textcolor{comment}{\ \ \ \ \ \ *\ complex.}}
\DoxyCodeLine{00070\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keyword}{typedef}\ std::complex<RealScalar>\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a3604c99a69fac3bee42c88cb2b589143}{ComplexScalar}};}
\DoxyCodeLine{00072\ \textcolor{comment}{}}
\DoxyCodeLine{00073\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Type\ for\ vector\ of\ eigenvalues\ as\ returned\ by\ eigenvalues().}}
\DoxyCodeLine{00074\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00075\ \textcolor{comment}{\ \ \ \ \ \ *\ This\ is\ a\ column\ vector\ with\ entries\ of\ type\ \#ComplexScalar.}}
\DoxyCodeLine{00076\ \textcolor{comment}{\ \ \ \ \ \ *\ The\ length\ of\ the\ vector\ is\ the\ size\ of\ \#MatrixType.}}
\DoxyCodeLine{00077\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix}}<\mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a3604c99a69fac3bee42c88cb2b589143}{ComplexScalar}},\ ColsAtCompileTime,\ 1,\ Options\&(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{\string~RowMajor}}),\ MaxColsAtCompileTime,\ 1>\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_ad3a663b1ff5200a098dabbbf9b7162b1}{EigenvalueType}};}
\DoxyCodeLine{00079\ \textcolor{comment}{}}
\DoxyCodeLine{00080\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Type\ for\ matrix\ of\ eigenvectors\ as\ returned\ by\ eigenvectors().}}
\DoxyCodeLine{00081\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00082\ \textcolor{comment}{\ \ \ \ \ \ *\ This\ is\ a\ square\ matrix\ with\ entries\ of\ type\ \#ComplexScalar.}}
\DoxyCodeLine{00083\ \textcolor{comment}{\ \ \ \ \ \ *\ The\ size\ is\ the\ same\ as\ the\ size\ of\ \#MatrixType.}}
\DoxyCodeLine{00084\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classEigen_1_1Matrix}{Matrix<ComplexScalar,\ RowsAtCompileTime,\ ColsAtCompileTime,\ Options,\ MaxRowsAtCompileTime,\ MaxColsAtCompileTime>}}\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a67cd4d20590abfd86b2639c4c8ea3dd6}{EigenvectorType}};}
\DoxyCodeLine{00086\ \textcolor{comment}{}}
\DoxyCodeLine{00087\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Default\ constructor.}}
\DoxyCodeLine{00088\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00089\ \textcolor{comment}{\ \ \ \ \ \ *\ The\ default\ constructor\ is\ useful\ in\ cases\ in\ which\ the\ user\ intends\ to}}
\DoxyCodeLine{00090\ \textcolor{comment}{\ \ \ \ \ \ *\ perform\ decompositions\ via\ compute().}}
\DoxyCodeLine{00091\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a3322a21574c61eefd450c003515ad802}{ComplexEigenSolver}}()}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_eivec(),}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_eivalues(),}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_schur(),}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_isInitialized(false),}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_eigenvectorsOk(false),}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_matX()}
\DoxyCodeLine{00099\ \ \ \ \ \{\}}
\DoxyCodeLine{00100\ \textcolor{comment}{}}
\DoxyCodeLine{00101\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Default\ Constructor\ with\ memory\ preallocation}}
\DoxyCodeLine{00102\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00103\ \textcolor{comment}{\ \ \ \ \ \ *\ Like\ the\ default\ constructor\ but\ with\ preallocation\ of\ the\ internal\ data}}
\DoxyCodeLine{00104\ \textcolor{comment}{\ \ \ \ \ \ *\ according\ to\ the\ specified\ problem\ \(\backslash\)a\ size.}}
\DoxyCodeLine{00105\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)sa\ ComplexEigenSolver()}}
\DoxyCodeLine{00106\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a86751f64ebcd5c554551fb5eaaa02db7}{ComplexEigenSolver}}(\mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_abc0218d8b902af0d6c759bfc0a8a8d74}{Index}}\ size)}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_eivec(size,\ size),}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_eivalues(size),}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_schur(size),}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_isInitialized(false),}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_eigenvectorsOk(false),}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_matX(size,\ size)}
\DoxyCodeLine{00114\ \ \ \ \ \{\}}
\DoxyCodeLine{00115\ \textcolor{comment}{}}
\DoxyCodeLine{00116\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Constructor;\ computes\ eigendecomposition\ of\ given\ matrix.}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00118\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)param[in]\ \ matrix\ \ Square\ matrix\ whose\ eigendecomposition\ is\ to\ be\ computed.}}
\DoxyCodeLine{00119\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)param[in]\ \ computeEigenvectors\ \ If\ true,\ both\ the\ eigenvectors\ and\ the}}
\DoxyCodeLine{00120\ \textcolor{comment}{\ \ \ \ \ \ *\ \ \ \ eigenvalues\ are\ computed;\ if\ false,\ only\ the\ eigenvalues\ are}}
\DoxyCodeLine{00121\ \textcolor{comment}{\ \ \ \ \ \ *\ \ \ \ computed.}}
\DoxyCodeLine{00122\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00123\ \textcolor{comment}{\ \ \ \ \ \ *\ This\ constructor\ calls\ compute()\ to\ compute\ the\ eigendecomposition.}}
\DoxyCodeLine{00124\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ InputType>}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a748de5c1e7f730e16421e6d451437600}{ComplexEigenSolver}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1EigenBase}{EigenBase<InputType>}}\&\ matrix,\ \textcolor{keywordtype}{bool}\ computeEigenvectors\ =\ \textcolor{keyword}{true})}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_eivec(matrix.rows(),matrix.cols()),}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_eivalues(matrix.cols()),}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_schur(matrix.rows()),}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_isInitialized(false),}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_eigenvectorsOk(false),}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_matX(matrix.rows(),matrix.cols())}
\DoxyCodeLine{00133\ \ \ \ \ \{}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_af5acd2af1ffbc97c798c06902b26b6c4}{compute}}(matrix.\mbox{\hyperlink{structEigen_1_1EigenBase_ab4cf3e6bb046a94a46b69b857bd3dbc9}{derived}}(),\ computeEigenvectors);}
\DoxyCodeLine{00135\ \ \ \ \ \}}
\DoxyCodeLine{00136\ \textcolor{comment}{}}
\DoxyCodeLine{00137\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Returns\ the\ eigenvectors\ of\ given\ matrix.}}
\DoxyCodeLine{00138\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00139\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)returns\ \ A\ const\ reference\ to\ the\ matrix\ whose\ columns\ are\ the\ eigenvectors.}}
\DoxyCodeLine{00140\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00141\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)pre\ Either\ the\ constructor}}
\DoxyCodeLine{00142\ \textcolor{comment}{\ \ \ \ \ \ *\ ComplexEigenSolver(const\ MatrixType\&\ matrix,\ bool)\ or\ the\ member}}
\DoxyCodeLine{00143\ \textcolor{comment}{\ \ \ \ \ \ *\ function\ compute(const\ MatrixType\&\ matrix,\ bool)\ has\ been\ called\ before}}
\DoxyCodeLine{00144\ \textcolor{comment}{\ \ \ \ \ \ *\ to\ compute\ the\ eigendecomposition\ of\ a\ matrix,\ and}}
\DoxyCodeLine{00145\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)p\ computeEigenvectors\ was\ set\ to\ true\ (the\ default).}}
\DoxyCodeLine{00146\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00147\ \textcolor{comment}{\ \ \ \ \ \ *\ This\ function\ returns\ a\ matrix\ whose\ columns\ are\ the\ eigenvectors.\ Column}}
\DoxyCodeLine{00148\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)f\$\ k\ \(\backslash\)f\$\ is\ an\ eigenvector\ corresponding\ to\ eigenvalue\ number\ \(\backslash\)f\$\ k}}
\DoxyCodeLine{00149\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)f\$\ as\ returned\ by\ eigenvalues().\ \ The\ eigenvectors\ are\ normalized\ to}}
\DoxyCodeLine{00150\ \textcolor{comment}{\ \ \ \ \ \ *\ have\ (Euclidean)\ norm\ equal\ to\ one.\ The\ matrix\ returned\ by\ this}}
\DoxyCodeLine{00151\ \textcolor{comment}{\ \ \ \ \ \ *\ function\ is\ the\ matrix\ \(\backslash\)f\$\ V\ \(\backslash\)f\$\ in\ the\ eigendecomposition\ \(\backslash\)f\$\ A\ =\ V\ D}}
\DoxyCodeLine{00152\ \textcolor{comment}{\ \ \ \ \ \ *\ V\string^\{-\/1\}\ \(\backslash\)f\$,\ if\ it\ exists.}}
\DoxyCodeLine{00153\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00154\ \textcolor{comment}{\ \ \ \ \ \ *\ Example:\ \(\backslash\)include\ ComplexEigenSolver\_eigenvectors.cpp}}
\DoxyCodeLine{00155\ \textcolor{comment}{\ \ \ \ \ \ *\ Output:\ \(\backslash\)verbinclude\ ComplexEigenSolver\_eigenvectors.out}}
\DoxyCodeLine{00156\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a67cd4d20590abfd86b2639c4c8ea3dd6}{EigenvectorType}}\&\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a3f455e33d41cde76f622f9b21f536be3}{eigenvectors}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00158\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ eigen\_assert(m\_isInitialized\ \&\&\ \textcolor{stringliteral}{"{}ComplexEigenSolver\ is\ not\ initialized."{}});}
\DoxyCodeLine{00160\ \ \ \ \ \ \ eigen\_assert(m\_eigenvectorsOk\ \&\&\ \textcolor{stringliteral}{"{}The\ eigenvectors\ have\ not\ been\ computed\ together\ with\ the\ eigenvalues."{}});}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_eivec;}
\DoxyCodeLine{00162\ \ \ \ \ \}}
\DoxyCodeLine{00163\ \textcolor{comment}{}}
\DoxyCodeLine{00164\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Returns\ the\ eigenvalues\ of\ given\ matrix.}}
\DoxyCodeLine{00165\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00166\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)returns\ A\ const\ reference\ to\ the\ column\ vector\ containing\ the\ eigenvalues.}}
\DoxyCodeLine{00167\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00168\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)pre\ Either\ the\ constructor}}
\DoxyCodeLine{00169\ \textcolor{comment}{\ \ \ \ \ \ *\ ComplexEigenSolver(const\ MatrixType\&\ matrix,\ bool)\ or\ the\ member}}
\DoxyCodeLine{00170\ \textcolor{comment}{\ \ \ \ \ \ *\ function\ compute(const\ MatrixType\&\ matrix,\ bool)\ has\ been\ called\ before}}
\DoxyCodeLine{00171\ \textcolor{comment}{\ \ \ \ \ \ *\ to\ compute\ the\ eigendecomposition\ of\ a\ matrix.}}
\DoxyCodeLine{00172\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00173\ \textcolor{comment}{\ \ \ \ \ \ *\ This\ function\ returns\ a\ column\ vector\ containing\ the}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ \ \ \ \ \ *\ eigenvalues.\ Eigenvalues\ are\ repeated\ according\ to\ their}}
\DoxyCodeLine{00175\ \textcolor{comment}{\ \ \ \ \ \ *\ algebraic\ multiplicity,\ so\ there\ are\ as\ many\ eigenvalues\ as}}
\DoxyCodeLine{00176\ \textcolor{comment}{\ \ \ \ \ \ *\ rows\ in\ the\ matrix.\ The\ eigenvalues\ are\ not\ sorted\ in\ any\ particular}}
\DoxyCodeLine{00177\ \textcolor{comment}{\ \ \ \ \ \ *\ order.}}
\DoxyCodeLine{00178\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00179\ \textcolor{comment}{\ \ \ \ \ \ *\ Example:\ \(\backslash\)include\ ComplexEigenSolver\_eigenvalues.cpp}}
\DoxyCodeLine{00180\ \textcolor{comment}{\ \ \ \ \ \ *\ Output:\ \(\backslash\)verbinclude\ ComplexEigenSolver\_eigenvalues.out}}
\DoxyCodeLine{00181\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_ad3a663b1ff5200a098dabbbf9b7162b1}{EigenvalueType}}\&\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a021de3dc1f37d4426a639eea39f9caae}{eigenvalues}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00183\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ eigen\_assert(m\_isInitialized\ \&\&\ \textcolor{stringliteral}{"{}ComplexEigenSolver\ is\ not\ initialized."{}});}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_eivalues;}
\DoxyCodeLine{00186\ \ \ \ \ \}}
\DoxyCodeLine{00187\ \textcolor{comment}{}}
\DoxyCodeLine{00188\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Computes\ eigendecomposition\ of\ given\ matrix.}}
\DoxyCodeLine{00189\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00190\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)param[in]\ \ matrix\ \ Square\ matrix\ whose\ eigendecomposition\ is\ to\ be\ computed.}}
\DoxyCodeLine{00191\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)param[in]\ \ computeEigenvectors\ \ If\ true,\ both\ the\ eigenvectors\ and\ the}}
\DoxyCodeLine{00192\ \textcolor{comment}{\ \ \ \ \ \ *\ \ \ \ eigenvalues\ are\ computed;\ if\ false,\ only\ the\ eigenvalues\ are}}
\DoxyCodeLine{00193\ \textcolor{comment}{\ \ \ \ \ \ *\ \ \ \ computed.}}
\DoxyCodeLine{00194\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)returns\ \ \ \ Reference\ to\ \(\backslash\)c\ *this}}
\DoxyCodeLine{00195\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00196\ \textcolor{comment}{\ \ \ \ \ \ *\ This\ function\ computes\ the\ eigenvalues\ of\ the\ complex\ matrix\ \(\backslash\)p\ matrix.}}
\DoxyCodeLine{00197\ \textcolor{comment}{\ \ \ \ \ \ *\ The\ eigenvalues()\ function\ can\ be\ used\ to\ retrieve\ them.\ \ If}}
\DoxyCodeLine{00198\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)p\ computeEigenvectors\ is\ true,\ then\ the\ eigenvectors\ are\ also\ computed}}
\DoxyCodeLine{00199\ \textcolor{comment}{\ \ \ \ \ \ *\ and\ can\ be\ retrieved\ by\ calling\ eigenvectors().}}
\DoxyCodeLine{00200\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00201\ \textcolor{comment}{\ \ \ \ \ \ *\ The\ matrix\ is\ first\ reduced\ to\ Schur\ form\ using\ the}}
\DoxyCodeLine{00202\ \textcolor{comment}{\ \ \ \ \ \ *\ ComplexSchur\ class.\ The\ Schur\ decomposition\ is\ then\ used\ to}}
\DoxyCodeLine{00203\ \textcolor{comment}{\ \ \ \ \ \ *\ compute\ the\ eigenvalues\ and\ eigenvectors.}}
\DoxyCodeLine{00204\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00205\ \textcolor{comment}{\ \ \ \ \ \ *\ The\ cost\ of\ the\ computation\ is\ dominated\ by\ the\ cost\ of\ the}}
\DoxyCodeLine{00206\ \textcolor{comment}{\ \ \ \ \ \ *\ Schur\ decomposition,\ which\ is\ \(\backslash\)f\$\ O(n\string^3)\ \(\backslash\)f\$\ where\ \(\backslash\)f\$\ n\ \(\backslash\)f\$}}
\DoxyCodeLine{00207\ \textcolor{comment}{\ \ \ \ \ \ *\ is\ the\ size\ of\ the\ matrix.}}
\DoxyCodeLine{00208\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00209\ \textcolor{comment}{\ \ \ \ \ \ *\ Example:\ \(\backslash\)include\ ComplexEigenSolver\_compute.cpp}}
\DoxyCodeLine{00210\ \textcolor{comment}{\ \ \ \ \ \ *\ Output:\ \(\backslash\)verbinclude\ ComplexEigenSolver\_compute.out}}
\DoxyCodeLine{00211\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ InputType>}
\DoxyCodeLine{00213\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a3322a21574c61eefd450c003515ad802}{ComplexEigenSolver}}\&\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_af5acd2af1ffbc97c798c06902b26b6c4}{compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1EigenBase}{EigenBase<InputType>}}\&\ matrix,\ \textcolor{keywordtype}{bool}\ computeEigenvectors\ =\ \textcolor{keyword}{true});}
\DoxyCodeLine{00214\ \textcolor{comment}{}}
\DoxyCodeLine{00215\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Reports\ whether\ previous\ computation\ was\ successful.}}
\DoxyCodeLine{00216\ \textcolor{comment}{\ \ \ \ \ \ *}}
\DoxyCodeLine{00217\ \textcolor{comment}{\ \ \ \ \ \ *\ \(\backslash\)returns\ \(\backslash\)c\ Success\ if\ computation\ was\ successful,\ \(\backslash\)c\ NoConvergence\ otherwise.}}
\DoxyCodeLine{00218\ \textcolor{comment}{\ \ \ \ \ \ */}}
\DoxyCodeLine{00219\ \ \ \ \ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_ad4d9d8b90145900b9686d2dabbe46730}{info}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00220\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ eigen\_assert(m\_isInitialized\ \&\&\ \textcolor{stringliteral}{"{}ComplexEigenSolver\ is\ not\ initialized."{}});}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_schur.info();}
\DoxyCodeLine{00223\ \ \ \ \ \}}
\DoxyCodeLine{00224\ \textcolor{comment}{}}
\DoxyCodeLine{00225\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Sets\ the\ maximum\ number\ of\ iterations\ allowed.\ */}}
\DoxyCodeLine{00226\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a3322a21574c61eefd450c003515ad802}{ComplexEigenSolver}}\&\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a0e62dccea1a84040c0602cede848505a}{setMaxIterations}}(\mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_abc0218d8b902af0d6c759bfc0a8a8d74}{Index}}\ maxIters)}
\DoxyCodeLine{00227\ \ \ \ \ \{}
\DoxyCodeLine{00228\ \ \ \ \ \ \ m\_schur.\mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a0e62dccea1a84040c0602cede848505a}{setMaxIterations}}(maxIters);}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00230\ \ \ \ \ \}}
\DoxyCodeLine{00231\ \textcolor{comment}{}}
\DoxyCodeLine{00232\ \textcolor{comment}{\ \ \ \ /**\ \(\backslash\)brief\ Returns\ the\ maximum\ number\ of\ iterations.\ */}}
\DoxyCodeLine{00233\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_abc0218d8b902af0d6c759bfc0a8a8d74}{Index}}\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_aeec4754e32bf2d1c650bf3aed110c3d3}{getMaxIterations}}()}
\DoxyCodeLine{00234\ \ \ \ \ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_schur.getMaxIterations();}
\DoxyCodeLine{00236\ \ \ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00239\ \ \ \ \ }
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ check\_template\_parameters()}
\DoxyCodeLine{00241\ \ \ \ \ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ EIGEN\_STATIC\_ASSERT\_NON\_INTEGER(\mbox{\hyperlink{classEigen_1_1Product}{Scalar}});}
\DoxyCodeLine{00243\ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ }
\DoxyCodeLine{00245\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a67cd4d20590abfd86b2639c4c8ea3dd6}{EigenvectorType}}\ m\_eivec;}
\DoxyCodeLine{00246\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_ad3a663b1ff5200a098dabbbf9b7162b1}{EigenvalueType}}\ m\_eivalues;}
\DoxyCodeLine{00247\ \ \ \ \ ComplexSchur<MatrixType>\ m\_schur;}
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_isInitialized;}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_eigenvectorsOk;}
\DoxyCodeLine{00250\ \ \ \ \ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_a67cd4d20590abfd86b2639c4c8ea3dd6}{EigenvectorType}}\ m\_matX;}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordtype}{void}\ doComputeEigenvectors(RealScalar\ matrixnorm);}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keywordtype}{void}\ sortEigenvalues(\textcolor{keywordtype}{bool}\ computeEigenvectors);}
\DoxyCodeLine{00255\ \};}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00259\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ InputType>}
\DoxyCodeLine{00260\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver}{ComplexEigenSolver<MatrixType>}}\&\ }
\DoxyCodeLine{00261\ \mbox{\hyperlink{classEigen_1_1ComplexEigenSolver_af5acd2af1ffbc97c798c06902b26b6c4}{ComplexEigenSolver<MatrixType>::compute}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structEigen_1_1EigenBase}{EigenBase<InputType>}}\&\ matrix,\ \textcolor{keywordtype}{bool}\ computeEigenvectors)}
\DoxyCodeLine{00262\ \{}
\DoxyCodeLine{00263\ \ \ check\_template\_parameters();}
\DoxyCodeLine{00264\ \ \ }
\DoxyCodeLine{00265\ \ \ \textcolor{comment}{//\ this\ code\ is\ inspired\ from\ Jampack}}
\DoxyCodeLine{00266\ \ \ eigen\_assert(matrix.cols()\ ==\ matrix.rows());}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \textcolor{comment}{//\ Do\ a\ complex\ Schur\ decomposition,\ A\ =\ U\ T\ U\string^*}}
\DoxyCodeLine{00269\ \ \ \textcolor{comment}{//\ The\ eigenvalues\ are\ on\ the\ diagonal\ of\ T.}}
\DoxyCodeLine{00270\ \ \ m\_schur.compute(matrix.derived(),\ computeEigenvectors);}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \textcolor{keywordflow}{if}(m\_schur.info()\ ==\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}})}
\DoxyCodeLine{00273\ \ \ \{}
\DoxyCodeLine{00274\ \ \ \ \ m\_eivalues\ =\ m\_schur.matrixT().diagonal();}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordflow}{if}(computeEigenvectors)}
\DoxyCodeLine{00276\ \ \ \ \ \ \ doComputeEigenvectors(m\_schur.matrixT().norm());}
\DoxyCodeLine{00277\ \ \ \ \ sortEigenvalues(computeEigenvectors);}
\DoxyCodeLine{00278\ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ m\_isInitialized\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00281\ \ \ m\_eigenvectorsOk\ =\ computeEigenvectors;}
\DoxyCodeLine{00282\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00283\ \}}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00287\ \textcolor{keywordtype}{void}\ ComplexEigenSolver<MatrixType>::doComputeEigenvectors(RealScalar\ matrixnorm)}
\DoxyCodeLine{00288\ \{}
\DoxyCodeLine{00289\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\ =\ m\_eivalues.size();}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ \ \ matrixnorm\ =\ numext::maxi(matrixnorm,(std::numeric\_limits<RealScalar>::min)());}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \textcolor{comment}{//\ Compute\ X\ such\ that\ T\ =\ X\ D\ X\string^(-\/1),\ where\ D\ is\ the\ diagonal\ of\ T.}}
\DoxyCodeLine{00294\ \ \ \textcolor{comment}{//\ The\ matrix\ X\ is\ unit\ triangular.}}
\DoxyCodeLine{00295\ \ \ m\_matX\ =\ EigenvectorType::Zero(n,\ n);}
\DoxyCodeLine{00296\ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k=n-\/1\ ;\ k>=0\ ;\ k-\/-\/)}
\DoxyCodeLine{00297\ \ \ \{}
\DoxyCodeLine{00298\ \ \ \ \ m\_matX.coeffRef(k,k)\ =\ ComplexScalar(1.0,0.0);}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{comment}{//\ Compute\ X(i,k)\ using\ the\ (i,k)\ entry\ of\ the\ equation\ X\ T\ =\ D\ X}}
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ i=k-\/1\ ;\ i>=0\ ;\ i-\/-\/)}
\DoxyCodeLine{00301\ \ \ \ \ \{}
\DoxyCodeLine{00302\ \ \ \ \ \ \ m\_matX.coeffRef(i,k)\ =\ -\/m\_schur.matrixT().coeff(i,k);}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(k-\/i-\/1>0)}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ m\_matX.coeffRef(i,k)\ -\/=\ (m\_schur.matrixT().row(i).segment(i+1,k-\/i-\/1)\ *\ m\_matX.col(k).segment(i+1,k-\/i-\/1)).value();}
\DoxyCodeLine{00305\ \ \ \ \ \ \ ComplexScalar\ z\ =\ m\_schur.matrixT().coeff(i,i)\ -\/\ m\_schur.matrixT().coeff(k,k);}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(z==ComplexScalar(0))}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ i-\/th\ and\ k-\/th\ eigenvalue\ are\ equal,\ then\ z\ equals\ 0.}}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ a\ small\ value\ instead,\ to\ prevent\ division\ by\ zero.}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ numext::real\_ref(z)\ =\ NumTraits<RealScalar>::epsilon()\ *\ matrixnorm;}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ m\_matX.coeffRef(i,k)\ =\ m\_matX.coeff(i,k)\ /\ z;}
\DoxyCodeLine{00313\ \ \ \ \ \}}
\DoxyCodeLine{00314\ \ \ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \textcolor{comment}{//\ Compute\ V\ as\ V\ =\ U\ X;\ now\ A\ =\ U\ T\ U\string^*\ =\ U\ X\ D\ X\string^(-\/1)\ U\string^*\ =\ V\ D\ V\string^(-\/1)}}
\DoxyCodeLine{00317\ \ \ m\_eivec.noalias()\ =\ m\_schur.matrixU()\ *\ m\_matX;}
\DoxyCodeLine{00318\ \ \ \textcolor{comment}{//\ ..\ and\ normalize\ the\ eigenvectors}}
\DoxyCodeLine{00319\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k\ =\ 0;\ k\ <\ n;\ k++)\ \{}
\DoxyCodeLine{00320\ \ \ \ \ m\_eivec.col(k).stableNormalize();}
\DoxyCodeLine{00321\ \ \ \}}
\DoxyCodeLine{00322\ \}}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00326\ \textcolor{keywordtype}{void}\ ComplexEigenSolver<MatrixType>::sortEigenvalues(\textcolor{keywordtype}{bool}\ computeEigenvectors)}
\DoxyCodeLine{00327\ \{}
\DoxyCodeLine{00328\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ n\ =\ \ m\_eivalues.size();}
\DoxyCodeLine{00329\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ i=0;\ i<n;\ i++)}
\DoxyCodeLine{00330\ \ \ \{}
\DoxyCodeLine{00331\ \ \ \ \ \mbox{\hyperlink{namespaceEigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}}\ k;}
\DoxyCodeLine{00332\ \ \ \ \ m\_eivalues.cwiseAbs().tail(n-\/i).minCoeff(\&k);}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ !=\ 0)}
\DoxyCodeLine{00334\ \ \ \ \ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ k\ +=\ i;}
\DoxyCodeLine{00336\ \ \ \ \ \ \ std::swap(m\_eivalues[k],m\_eivalues[i]);}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(computeEigenvectors)}
\DoxyCodeLine{00338\ \ \ \ \ m\_eivec.col(i).swap(m\_eivec.col(k));}
\DoxyCodeLine{00339\ \ \ \ \ \}}
\DoxyCodeLine{00340\ \ \ \}}
\DoxyCodeLine{00341\ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_COMPLEX\_EIGEN\_SOLVER\_H}}

\end{DoxyCode}
